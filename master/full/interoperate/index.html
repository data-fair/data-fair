<!doctype html>
<html data-n-head-ssr>
  <head>
    <title>DataFair</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="application" name="application-name" content="DataFair"><meta data-n-head="ssr" data-hid="description" name="description" content="DataFair - Documentation"><base href="/data-fair/master/"><link data-n-head="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito:300,400,500,700,400italic|Material+Icons"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="favicon.ico"><link data-n-head="ssr" rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Nunito:100,300,400,500,700,900&display=swap"><link data-n-head="ssr" rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/@mdi/font@latest/css/materialdesignicons.min.css"><style data-n-head="vuetify" type="text/css" id="vuetify-theme-stylesheet" nonce="undefined">.v-application a{color:#1e88e5}.v-application .primary{background-color:#1e88e5!important;border-color:#1e88e5!important}.v-application .primary--text{color:#1e88e5!important;caret-color:#1e88e5!important}.v-application .primary.lighten-5{background-color:#cfffff!important;border-color:#cfffff!important}.v-application .primary--text.text--lighten-5{color:#cfffff!important;caret-color:#cfffff!important}.v-application .primary.lighten-4{background-color:#b0f5ff!important;border-color:#b0f5ff!important}.v-application .primary--text.text--lighten-4{color:#b0f5ff!important;caret-color:#b0f5ff!important}.v-application .primary.lighten-3{background-color:#91d8ff!important;border-color:#91d8ff!important}.v-application .primary--text.text--lighten-3{color:#91d8ff!important;caret-color:#91d8ff!important}.v-application .primary.lighten-2{background-color:#70bdff!important;border-color:#70bdff!important}.v-application .primary--text.text--lighten-2{color:#70bdff!important;caret-color:#70bdff!important}.v-application .primary.lighten-1{background-color:#4da2ff!important;border-color:#4da2ff!important}.v-application .primary--text.text--lighten-1{color:#4da2ff!important;caret-color:#4da2ff!important}.v-application .primary.darken-1{background-color:#006fc9!important;border-color:#006fc9!important}.v-application .primary--text.text--darken-1{color:#006fc9!important;caret-color:#006fc9!important}.v-application .primary.darken-2{background-color:#0057ad!important;border-color:#0057ad!important}.v-application .primary--text.text--darken-2{color:#0057ad!important;caret-color:#0057ad!important}.v-application .primary.darken-3{background-color:#004092!important;border-color:#004092!important}.v-application .primary--text.text--darken-3{color:#004092!important;caret-color:#004092!important}.v-application .primary.darken-4{background-color:#002b78!important;border-color:#002b78!important}.v-application .primary--text.text--darken-4{color:#002b78!important;caret-color:#002b78!important}.v-application .secondary{background-color:#42a5f5!important;border-color:#42a5f5!important}.v-application .secondary--text{color:#42a5f5!important;caret-color:#42a5f5!important}.v-application .secondary.lighten-5{background-color:#e4ffff!important;border-color:#e4ffff!important}.v-application .secondary--text.text--lighten-5{color:#e4ffff!important;caret-color:#e4ffff!important}.v-application .secondary.lighten-4{background-color:#c5ffff!important;border-color:#c5ffff!important}.v-application .secondary--text.text--lighten-4{color:#c5ffff!important;caret-color:#c5ffff!important}.v-application .secondary.lighten-3{background-color:#a6f8ff!important;border-color:#a6f8ff!important}.v-application .secondary--text.text--lighten-3{color:#a6f8ff!important;caret-color:#a6f8ff!important}.v-application .secondary.lighten-2{background-color:#87dcff!important;border-color:#87dcff!important}.v-application .secondary--text.text--lighten-2{color:#87dcff!important;caret-color:#87dcff!important}.v-application .secondary.lighten-1{background-color:#66c0ff!important;border-color:#66c0ff!important}.v-application .secondary--text.text--lighten-1{color:#66c0ff!important;caret-color:#66c0ff!important}.v-application .secondary.darken-1{background-color:#018bd8!important;border-color:#018bd8!important}.v-application .secondary--text.text--darken-1{color:#018bd8!important;caret-color:#018bd8!important}.v-application .secondary.darken-2{background-color:#0072bc!important;border-color:#0072bc!important}.v-application .secondary--text.text--darken-2{color:#0072bc!important;caret-color:#0072bc!important}.v-application .secondary.darken-3{background-color:#0059a1!important;border-color:#0059a1!important}.v-application .secondary--text.text--darken-3{color:#0059a1!important;caret-color:#0059a1!important}.v-application .secondary.darken-4{background-color:#004286!important;border-color:#004286!important}.v-application .secondary--text.text--darken-4{color:#004286!important;caret-color:#004286!important}.v-application .accent{background-color:#ff9800!important;border-color:#ff9800!important}.v-application .accent--text{color:#ff9800!important;caret-color:#ff9800!important}.v-application .accent.lighten-5{background-color:#ffffa2!important;border-color:#ffffa2!important}.v-application .accent--text.text--lighten-5{color:#ffffa2!important;caret-color:#ffffa2!important}.v-application .accent.lighten-4{background-color:#ffff85!important;border-color:#ffff85!important}.v-application .accent--text.text--lighten-4{color:#ffff85!important;caret-color:#ffff85!important}.v-application .accent.lighten-3{background-color:#ffeb69!important;border-color:#ffeb69!important}.v-application .accent--text.text--lighten-3{color:#ffeb69!important;caret-color:#ffeb69!important}.v-application .accent.lighten-2{background-color:#ffcf4d!important;border-color:#ffcf4d!important}.v-application .accent--text.text--lighten-2{color:#ffcf4d!important;caret-color:#ffcf4d!important}.v-application .accent.lighten-1{background-color:#ffb32f!important;border-color:#ffb32f!important}.v-application .accent--text.text--lighten-1{color:#ffb32f!important;caret-color:#ffb32f!important}.v-application .accent.darken-1{background-color:#df7e00!important;border-color:#df7e00!important}.v-application .accent--text.text--darken-1{color:#df7e00!important;caret-color:#df7e00!important}.v-application .accent.darken-2{background-color:#bf6400!important;border-color:#bf6400!important}.v-application .accent--text.text--darken-2{color:#bf6400!important;caret-color:#bf6400!important}.v-application .accent.darken-3{background-color:#a14c00!important;border-color:#a14c00!important}.v-application .accent--text.text--darken-3{color:#a14c00!important;caret-color:#a14c00!important}.v-application .accent.darken-4{background-color:#843300!important;border-color:#843300!important}.v-application .accent--text.text--darken-4{color:#843300!important;caret-color:#843300!important}.v-application .error{background-color:#ff5252!important;border-color:#ff5252!important}.v-application .error--text{color:#ff5252!important;caret-color:#ff5252!important}.v-application .error.lighten-5{background-color:#ffe4d5!important;border-color:#ffe4d5!important}.v-application .error--text.text--lighten-5{color:#ffe4d5!important;caret-color:#ffe4d5!important}.v-application .error.lighten-4{background-color:#ffc6b9!important;border-color:#ffc6b9!important}.v-application .error--text.text--lighten-4{color:#ffc6b9!important;caret-color:#ffc6b9!important}.v-application .error.lighten-3{background-color:#ffa99e!important;border-color:#ffa99e!important}.v-application .error--text.text--lighten-3{color:#ffa99e!important;caret-color:#ffa99e!important}.v-application .error.lighten-2{background-color:#ff8c84!important;border-color:#ff8c84!important}.v-application .error--text.text--lighten-2{color:#ff8c84!important;caret-color:#ff8c84!important}.v-application .error.lighten-1{background-color:#ff6f6a!important;border-color:#ff6f6a!important}.v-application .error--text.text--lighten-1{color:#ff6f6a!important;caret-color:#ff6f6a!important}.v-application .error.darken-1{background-color:#df323b!important;border-color:#df323b!important}.v-application .error--text.text--darken-1{color:#df323b!important;caret-color:#df323b!important}.v-application .error.darken-2{background-color:#bf0025!important;border-color:#bf0025!important}.v-application .error--text.text--darken-2{color:#bf0025!important;caret-color:#bf0025!important}.v-application .error.darken-3{background-color:#9f0010!important;border-color:#9f0010!important}.v-application .error--text.text--darken-3{color:#9f0010!important;caret-color:#9f0010!important}.v-application .error.darken-4{background-color:maroon!important;border-color:maroon!important}.v-application .error--text.text--darken-4{color:maroon!important;caret-color:maroon!important}.v-application .info{background-color:#2196f3!important;border-color:#2196f3!important}.v-application .info--text{color:#2196f3!important;caret-color:#2196f3!important}.v-application .info.lighten-5{background-color:#d4ffff!important;border-color:#d4ffff!important}.v-application .info--text.text--lighten-5{color:#d4ffff!important;caret-color:#d4ffff!important}.v-application .info.lighten-4{background-color:#b5ffff!important;border-color:#b5ffff!important}.v-application .info--text.text--lighten-4{color:#b5ffff!important;caret-color:#b5ffff!important}.v-application .info.lighten-3{background-color:#95e8ff!important;border-color:#95e8ff!important}.v-application .info--text.text--lighten-3{color:#95e8ff!important;caret-color:#95e8ff!important}.v-application .info.lighten-2{background-color:#75ccff!important;border-color:#75ccff!important}.v-application .info--text.text--lighten-2{color:#75ccff!important;caret-color:#75ccff!important}.v-application .info.lighten-1{background-color:#51b0ff!important;border-color:#51b0ff!important}.v-application .info--text.text--lighten-1{color:#51b0ff!important;caret-color:#51b0ff!important}.v-application .info.darken-1{background-color:#007cd6!important;border-color:#007cd6!important}.v-application .info--text.text--darken-1{color:#007cd6!important;caret-color:#007cd6!important}.v-application .info.darken-2{background-color:#0064ba!important;border-color:#0064ba!important}.v-application .info--text.text--darken-2{color:#0064ba!important;caret-color:#0064ba!important}.v-application .info.darken-3{background-color:#004d9f!important;border-color:#004d9f!important}.v-application .info--text.text--darken-3{color:#004d9f!important;caret-color:#004d9f!important}.v-application .info.darken-4{background-color:#003784!important;border-color:#003784!important}.v-application .info--text.text--darken-4{color:#003784!important;caret-color:#003784!important}.v-application .success{background-color:#4caf50!important;border-color:#4caf50!important}.v-application .success--text{color:#4caf50!important;caret-color:#4caf50!important}.v-application .success.lighten-5{background-color:#dcffd6!important;border-color:#dcffd6!important}.v-application .success--text.text--lighten-5{color:#dcffd6!important;caret-color:#dcffd6!important}.v-application .success.lighten-4{background-color:#beffba!important;border-color:#beffba!important}.v-application .success--text.text--lighten-4{color:#beffba!important;caret-color:#beffba!important}.v-application .success.lighten-3{background-color:#a2ff9e!important;border-color:#a2ff9e!important}.v-application .success--text.text--lighten-3{color:#a2ff9e!important;caret-color:#a2ff9e!important}.v-application .success.lighten-2{background-color:#85e783!important;border-color:#85e783!important}.v-application .success--text.text--lighten-2{color:#85e783!important;caret-color:#85e783!important}.v-application .success.lighten-1{background-color:#69cb69!important;border-color:#69cb69!important}.v-application .success--text.text--lighten-1{color:#69cb69!important;caret-color:#69cb69!important}.v-application .success.darken-1{background-color:#2d9437!important;border-color:#2d9437!important}.v-application .success--text.text--darken-1{color:#2d9437!important;caret-color:#2d9437!important}.v-application .success.darken-2{background-color:#00791e!important;border-color:#00791e!important}.v-application .success--text.text--darken-2{color:#00791e!important;caret-color:#00791e!important}.v-application .success.darken-3{background-color:#006000!important;border-color:#006000!important}.v-application .success--text.text--darken-3{color:#006000!important;caret-color:#006000!important}.v-application .success.darken-4{background-color:#004700!important;border-color:#004700!important}.v-application .success--text.text--darken-4{color:#004700!important;caret-color:#004700!important}.v-application .warning{background-color:#e91e63!important;border-color:#e91e63!important}.v-application .warning--text{color:#e91e63!important;caret-color:#e91e63!important}.v-application .warning.lighten-5{background-color:#ffc0e7!important;border-color:#ffc0e7!important}.v-application .warning--text.text--lighten-5{color:#ffc0e7!important;caret-color:#ffc0e7!important}.v-application .warning.lighten-4{background-color:#ffa3cb!important;border-color:#ffa3cb!important}.v-application .warning--text.text--lighten-4{color:#ffa3cb!important;caret-color:#ffa3cb!important}.v-application .warning.lighten-3{background-color:#ff85b0!important;border-color:#ff85b0!important}.v-application .warning--text.text--lighten-3{color:#ff85b0!important;caret-color:#ff85b0!important}.v-application .warning.lighten-2{background-color:#ff6795!important;border-color:#ff6795!important}.v-application .warning--text.text--lighten-2{color:#ff6795!important;caret-color:#ff6795!important}.v-application .warning.lighten-1{background-color:#ff467c!important;border-color:#ff467c!important}.v-application .warning--text.text--lighten-1{color:#ff467c!important;caret-color:#ff467c!important}.v-application .warning.darken-1{background-color:#c9004b!important;border-color:#c9004b!important}.v-application .warning--text.text--darken-1{color:#c9004b!important;caret-color:#c9004b!important}.v-application .warning.darken-2{background-color:#aa0035!important;border-color:#aa0035!important}.v-application .warning--text.text--darken-2{color:#aa0035!important;caret-color:#aa0035!important}.v-application .warning.darken-3{background-color:#8b0021!important;border-color:#8b0021!important}.v-application .warning--text.text--darken-3{color:#8b0021!important;caret-color:#8b0021!important}.v-application .warning.darken-4{background-color:#6c000a!important;border-color:#6c000a!important}.v-application .warning--text.text--darken-4{color:#6c000a!important;caret-color:#6c000a!important}.v-application .admin{background-color:#e53935!important;border-color:#e53935!important}.v-application .admin--text{color:#e53935!important;caret-color:#e53935!important}.v-application .admin.lighten-5{background-color:#ffccb3!important;border-color:#ffccb3!important}.v-application .admin--text.text--lighten-5{color:#ffccb3!important;caret-color:#ffccb3!important}.v-application .admin.lighten-4{background-color:#ffaf98!important;border-color:#ffaf98!important}.v-application .admin--text.text--lighten-4{color:#ffaf98!important;caret-color:#ffaf98!important}.v-application .admin.lighten-3{background-color:#ff927e!important;border-color:#ff927e!important}.v-application .admin--text.text--lighten-3{color:#ff927e!important;caret-color:#ff927e!important}.v-application .admin.lighten-2{background-color:#ff7565!important;border-color:#ff7565!important}.v-application .admin--text.text--lighten-2{color:#ff7565!important;caret-color:#ff7565!important}.v-application .admin.lighten-1{background-color:#ff584c!important;border-color:#ff584c!important}.v-application .admin--text.text--lighten-1{color:#ff584c!important;caret-color:#ff584c!important}.v-application .admin.darken-1{background-color:#c50f1f!important;border-color:#c50f1f!important}.v-application .admin--text.text--darken-1{color:#c50f1f!important;caret-color:#c50f1f!important}.v-application .admin.darken-2{background-color:#a50009!important;border-color:#a50009!important}.v-application .admin--text.text--darken-2{color:#a50009!important;caret-color:#a50009!important}.v-application .admin.darken-3{background-color:#860000!important;border-color:#860000!important}.v-application .admin--text.text--darken-3{color:#860000!important;caret-color:#860000!important}.v-application .admin.darken-4{background-color:#690000!important;border-color:#690000!important}.v-application .admin--text.text--darken-4{color:#690000!important;caret-color:#690000!important}</style><link rel="preload" href="/data-fair/master/_nuxt/06a154a.js" as="script"><link rel="preload" href="/data-fair/master/_nuxt/7f0cd2a.js" as="script"><link rel="preload" href="/data-fair/master/_nuxt/css/73cb789.css" as="style"><link rel="preload" href="/data-fair/master/_nuxt/4cdf224.js" as="script"><link rel="preload" href="/data-fair/master/_nuxt/css/5c9a69b.css" as="style"><link rel="preload" href="/data-fair/master/_nuxt/c90eb1d.js" as="script"><link rel="preload" href="/data-fair/master/_nuxt/css/84187a3.css" as="style"><link rel="preload" href="/data-fair/master/_nuxt/d96bad6.js" as="script"><link rel="stylesheet" href="/data-fair/master/_nuxt/css/73cb789.css"><link rel="stylesheet" href="/data-fair/master/_nuxt/css/5c9a69b.css"><link rel="stylesheet" href="/data-fair/master/_nuxt/css/84187a3.css"><link rel="preload" href="/data-fair/master/_nuxt/static/1622724187/full/interoperate/state.js" as="script"><link rel="preload" href="/data-fair/master/_nuxt/static/1622724187/full/interoperate/payload.js" as="script"><link rel="preload" href="/data-fair/master/_nuxt/static/1622724187/manifest.js" as="script">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div data-app="true" id="app" class="v-application v-application--is-ltr theme--light"><div class="v-application--wrap"><main class="v-main" style="padding-top:0;padding-right:0;padding-bottom:0;padding-left:0"><div class="v-main__wrap"><div><div class="mt-6 pt-6 text-center col"><div class="v-image v-responsive my-6 theme--light" style="height:160px"><div class="v-image__image v-image__image--preload v-image__image--contain" style="background-position:center center"></div><div class="v-responsive__content"></div></div> <h1 class="text-h3 grey--text text--darken-3">
      Data Fair
    </h1> <h4>
      Version 2.29.3
    </h4> <h1 class="text-h3 grey--text text--darken-3" style="margin-top:200px">
      Interopérer
    </h1> <h4 style="margin-top:200px!important">
      03 juin 2021
    </h4></div> <div class="page-break"></div> <h2 class="text-h4 my-4 grey--text text--darken-3">
    Table des matières
  </h2> <h4>
      1 - API Data Fair
    </h4><h4>
      2 - Applications de visualisation
    </h4><h4>
      3 - Services externes
    </h4><h4>
      3 - Collecteurs de données
    </h4><h4>
      5 - Connecteurs de catalogues
    </h4> <div class="page-break"></div> <h2 class="text-h4 my-4 grey--text text--darken-3">
      1 - API Data Fair
    </h2> <div class="article"><p>Data Fair expose une API Rest complète. Une partie de cette API est essentiellement à destination des applications et autres réutilisations des jeux de données. Une autre partie concerne principalement les producteurs de contenu qui souhaitent automatiser leur processus. Dans cette page nous proposons un aperçu de quelques méthodes de publication de contenu. Les exemples ci-dessous ne montrent qu'un échantillon des capacités de l'API Data Fair et ne remplacent pas la documentation interactive bien plus complète embarquée dans le service.</p>
<h3 id="pré-requis">Pré-requis</h3>
<ul>
<li>Une installation opérationnelle de Data FAIR, soit locale, soit publique comme sur <a href="https://koumoul.com/s/data-fair">koumoul.com</a></li>
<li>Un compte et une clé d'API avec la portée "Gestion des jeux de données" (voir vos paramètres personnels ou d'organisation dans le menu en haut à droite)</li>
<li><a href="https://curl.haxx.se/">curl</a> ou autre client HTTP à condition d'adapter les exemples</li>
</ul>
<p>Définissez une variable contenant votre clé d'API :</p>
<pre><code class="language-sh">export API_KEY="XXXX"</code></pre>
<p>Définissez une variable contenant l'URL de base de votre instance Data Fair :</p>
<pre><code class="language-sh">export Data Fair_URL="https://koumoul.com/s/data-fair"
export Data Fair_URL="http://localhost/data-fair"</code></pre>
<h3 id="jeu-de-données-simple-basé-fichier">Jeu de données simple basé fichier</h3>
<p>Téléchargez un fichier CSV d'exemple :</p>
<pre><code class="language-sh">curl https://raw.githubusercontent.com/koumoul-dev/data-fair/master/test/resources/dataset1.csv -o dataset1.csv</code></pre>
<p>Créez un jeu de données simple à partir de ce fichier avec une requête HTTP multipart :</p>
<pre><code class="language-sh">curl -v --header "x-apiKey: $API_KEY" --form file=@dataset1.csv $Data Fair_URL/api/v1/datasets</code></pre>
<p>Notez dans le retour que le jeu de données créé s'est vu attribué un identifiant "id" que vous pouvez conserver pour effectuer des opérations ultérieures sur ce jeu de données.</p>
<pre><code class="language-sh">export DATASET_ID=identifiant que vous venez de recevoir</code></pre>
<p>L'attribut "status" est à "loaded". Notez que les traitements sur le jeu de données sont exécutés de manière asynchrone, quelques secondes plus tard le statut devrait devenir "finalized" en passant par des étapes intermédiaires. Pour vérifier cela vous pouvez faire un GET sur le jeu de données :</p>
<pre><code class="language-sh">curl -v --header "x-apiKey: $API_KEY" $Data Fair_URL/api/v1/datasets/$DATASET_ID</code></pre>
<p>L'attribut page est lui aussi intéressant, il vous permet de naviguer dans un navigateur directement sur la page de description du jeu de données. Pour connaître l'étendue des capacités de requêtage sur ce jeu de données vous pouvez vous rendre sur l'onglet API depuis cette page. Voici un exemple basique :</p>
<pre><code class="language-sh">curl -v --header "x-apiKey: $API_KEY" $Data Fair_URL/api/v1/datasets/$DATASET_ID/lines</code></pre>
<h3 id="jeu-de-données-basé-fichier-avec-pièces-jointes">Jeu de données basé fichier avec pièces jointes</h3>
<p>Téléchargez un fichier CSV d'exemple qui contient une colonne de chemins vers des pièces jointes :</p>
<pre><code class="language-sh">curl https://raw.githubusercontent.com/koumoul-dev/data-fair/master/test/resources/dataset-attachments.csv -o dataset-attachments.csv</code></pre>
<p>Téléchargez l'archive contenant les pièces jointes correspondantes :</p>
<pre><code class="language-sh">curl https://raw.githubusercontent.com/koumoul-dev/data-fair/master/test/resources/files.zip -o files.zip</code></pre>
<p>Créez un jeu de données basé sur le CSV et enrichi avec les pièces jointes de l'archive grâce à cette requête HTTP multipart :</p>
<pre><code class="language-sh">curl -v --header "x-apiKey: $API_KEY" --form file=@dataset-attachments.csv --form attachments=@files.zip $Data Fair_URL/api/v1/datasets
export DATASET_ID=identifiant que vous venez de recevoir</code></pre>
<p>Si vous visitez la page de ce jeu de données vous verrez un onglet "Fichiers" supplémentaire qui permet de lister les pièces jointes et d'effectuer des recherches dans leur contenu. En effectuant une requête basique sur le jeu de données vous pouvez constater l'ajout de champs _file.* qui sont issus de l'analyse du contenu des pièces jointes.</p>
<h3 id="jeu-de-données-incrémental">Jeu de données incrémental</h3>
<p>Créez un jeu de données incrémental vide avec un schéma minimaliste. Notez l'attribut "isRest" qui est la condition pour créer ce type de jeu de données :</p>
<pre><code class="language-sh">curl -v --header "x-apiKey: $API_KEY" --header "Content-Type: application/json" $Data Fair_URL/api/v1/datasets --data '{
  "isRest": true,
  "title": "rest1",
  "schema": [{ "key": "attr1", "type": "string" }, { "key": "attr2", "type": "string" }]
}'
export DATASET_ID=identifiant que vous venez de recevoir</code></pre>
<p>Ajouter une ligne de donnée :</p>
<pre><code class="language-sh">curl -v --header "x-apiKey: $API_KEY" --header "Content-Type: application/json" $Data Fair_URL/api/v1/datasets/$DATASET_ID/lines --data '{
  "_id": "ligne1",
  "attr1": "attr1 ligne1",
  "attr2": "attr2 ligne1"
}'</code></pre>
<p>Ajoutez/modifiez plusieurs lignes de donnée :</p>
<pre><code class="language-sh">curl -v --header "x-apiKey: $API_KEY" --header "Content-Type: application/json" $Data Fair_URL/api/v1/datasets/$DATASET_ID/_bulk_lines --data '[
  { "_id": "ligne1", "_action": "patch", "attr1": "attr1 ligne1 autre valeur"},
  { "_id": "ligne2", "attr1": "attr1 ligne2", "attr2": "attr2 ligne2"}
]'</code></pre>
<p>Vérifiez la donnée :</p>
<pre><code class="language-sh">curl -v --header "x-apiKey: $API_KEY" $Data Fair_URL/api/v1/datasets/$DATASET_ID/lines</code></pre>
<h3 id="jeu-de-données-incrémental-avec-pièces-jointes">Jeu de données incrémental avec pièces jointes</h3>
<p>Créez un jeu de données incrémental vide avec un schéma qui contient un champ type <em>pièces jointes</em> :</p>
<pre><code class="language-sh">curl -v --header "x-apiKey: $API_KEY" --header "Content-Type: application/json" $Data Fair_URL/api/v1/datasets --data '{
  "isRest": true,
  "title": "rest1",
  "schema": [
    { "key": "attr1", "type": "string" },
    { "key": "attachmentPath", "type": "string", "x-refersTo": "http://schema.org/DigitalDocument" }
  ]
}'
export DATASET_ID=identifiant que vous venez de recevoir</code></pre>
<p>Ajoutez plusieurs lignes de données avec pièces jointes dans une archive :</p>
<pre><code class="language-sh">echo '[
  { "_id": "line1", "attr1": "test1", "attachmentPath": "test.odt" },
  { "_id": "line2", "attr1": "test1", "attachmentPath": "dir1/test.pdf" }
]' > actions.json
curl -v --header "x-apiKey: $API_KEY" $Data Fair_URL/api/v1/datasets/$DATASET_ID/_bulk_lines --form attachments=@files.zip --form actions=@actions.json</code></pre>
<p>Vérifiez la donnée :</p>
<pre><code class="language-sh">curl -v --header "x-apiKey: $API_KEY" $Data Fair_URL/api/v1/datasets/$DATASET_ID/lines</code></pre>
</div><div class="page-break"></div> <h2 class="text-h4 my-4 grey--text text--darken-3">
      2 - Applications de visualisation
    </h2> <div class="article"><p>N'importe qui peut développer une nouvelle application de visualisation de données compatible avec Data Fair. Ces applications sont mises à disposition sous forme de services : ce sont des applications Web disponibles en ligne. Une instance de Data Fair fait office de proxy vers les applications configurées et les réexpose en leur communiquant les informations de contexte dont elles ont besoin. Pour pouvoir être intégrée dans une instance Data Fair, une application doit exposer certaines informations.</p>
<h3 id="exemples">Exemples</h3>
<ul>
<li>Une application statique développée avec des frameworks modernes : <a href="https://github.com/koumoul-dev/data-fair-charts">data-fair-charts</a></li>
<li>Une application statique minimaliste en HTML/JS/CSS pur avec juste un petit peu de jQuery : <a href="https://github.com/koumoul-dev/data-fair-minimal">data-fair-minimal</a></li>
</ul>
<h3 id="métadonnées-essentielles">Métadonnées essentielles</h3>
<p>Une application expose un fichier HTML, typiquement un fichier <code>ìndex.html</code> à sa racine. Ce fichier doit contenir certaines informations, renseignées dans des balises de la section HEAD :</p>
<ul>
<li><strong>title</strong> : Le titre de l'application, dans une balise title.</li>
<li><strong>description</strong> : La description de l'application, dans une balise meta.</li>
</ul>
<h3 id="gestion-des-configurations">Gestion des configurations</h3>
<p>Une application doit donner à Data Fair le moyen de créer et éditer des configurations cohérentes avec ses besoins. Les configurations sont décrites à l'aide de JSON schéma, en servant à la racine de l'application un fichier <code>config-schema.json</code>. Ce fichier peut avoir des annotations particulières qui permettent d'avoir du contrôle sur le formulaire de configuration qui sera généré.</p>
<p>Ce formulaire est généré à l'aide de la librairie <a href="https://github.com/koumoul-dev/vuetify-jsonschema-form/">vuetify-jsonschema-form</a> (v-jsf), la documentation des différente annotations JSON schéma utilisée est <a href="https://koumoul-dev.github.io/vuetify-jsonschema-form/latest/">disponible ici</a>.</p>
<h3 id="informations-de-contexte">Informations de contexte</h3>
<h4 id="côté-client">Côté client</h4>
<p>Par simplicité nous privilégions des applications statiques déployables sur un simple serveur Web comme nos applications exemples. Pour ces applications nous avons prévu un mécanisme simple de transmission des informations contextuelles.</p>
<p>Le proxy Data Fair cherche dans le contenu HTML qui transite la chaîne de caractère %APPLICATION% et la remplace par la configuration d'application complète au format JSON. Le code Javascript peut donc récupérer cet objet et l'utiliser pour effectuer un rendu adapté et consommer l'API de Data FAIR en conséquence. L'objet JSON transmis contient les champs suivants :</p>
<ul>
<li><strong>title</strong>: Titre de la visualisation configurée</li>
<li><strong>url</strong>: URL ou est exposée l'application utilisée pour la configuration</li>
<li><strong>id</strong>: Identifiant de la visualisation</li>
<li><strong>status</strong>: Etat de la configuration (brouillon, publié, ...)</li>
<li><strong>configuration</strong>: La structure de cet objet dépend du schéma de configuration de l'application utilisée</li>
<li><strong>href</strong>: Point d'accès de l'API Data Fair permettant de lire / modifier la configuration d'application</li>
<li><strong>page</strong>: Page qui présente la visualisation</li>
<li><strong>exposedUrl</strong>: URL d'exposition de la visualisation, peut être utilisée dans une iFrame ou en accès direct</li>
<li><strong>apiUrl</strong>: URL de l'API Data Fair</li>
<li><strong>captureUrl</strong>: URL vers le service de capture, permet de réaliser des exports image ou impressions PDF</li>
<li><strong>wsUrl</strong>: URL de la web socket Data Fair, utile pour les applications qui manipulent des données mise a jour en temps réel</li>
</ul>
<h4 id="côté-serveur">Côté serveur</h4>
<p>Il est aussi possible de développer une application avec rendu côté serveur. Dans ce cas le mode de transmission des informations contextuelles est différent.</p>
<p>Ces informations sont transmises à l'aide de headers HTTP que le serveur de l'application interprète. Les headers suivant sont transmis par le service :</p>
<ul>
<li><strong>X-Exposed-Url</strong> : URL d'exposition de la visualisation, peut être utilisée dans une iFrame ou en accès direct</li>
<li><strong>X-Application-Url</strong> : URL à utiliser pour connaître le propriétaire de l'application, les droits de l'utilisateur courant (pour par exemple masquer / afficher un bouton de configuration).</li>
<li><strong>X-API-Url</strong> : URL de l'API de c, ce qui permet ensuite d'accéder aux services distants et aux datasets</li>
<li><strong>X-Directory-Url</strong>: URL vers le service de gestion des utilisateurs.</li>
</ul>
<h3 id="outils-de-développement">Outils de développement</h3>
<h4 id="serveur-de-développement-data-fair">Serveur de développement Data Fair</h4>
<p>Le projet <a href="https://github.com/koumoul-dev/df-dev-server">df-dev-server</a> permet de simplifier le développement des applications Data Fair.</p>
<ul>
<li>Il est plus léger que Data Fair car il n'a pas besoin des différents services en local (bases de données, gestion utilisateurs, ...)</li>
<li>Il permet d'avoir déjà des données de disponible en se connectant à des sources distantes</li>
<li>Il est plus facile a faire fonctionner sous Windows, car ne nécessite pas Docker</li>
<li>Il nécessite par contre une connexion internet pour pouvoir accéder aux données</li>
</ul>
</div><div class="page-break"></div> <h2 class="text-h4 my-4 grey--text text--darken-3">
      3 - Services externes
    </h2> <div class="article"><p>Une API peut être utlisée par ce service si elle respecte certains critères. Elle doit être décrite avec un certain formalisme : spécification OpenAPI 3.0, annotations sémantiques particulières et mécanisme d'identification de l'API.</p>
<h3 id="spécification-openapi-30">Spécification OpenAPI 3.0</h3>
<p>Le schéma utilisé pour décrire une API est celui de la <a href="https://github.com/OAI/OpenAPI-Specification/blob/master/versions/3.0.0.md">spécification OpenAPI 3.0</a>. Le format à utiliser est JSON (YAML sera supporté prochainement). Les autres formats ne sont pas supportés, en particulier le format Swagger 2.0. Si votre API est décrite dans un autre format, <a href="https://github.com/Mermade/awesome-openapi3">certains outils</a> permettent de la convertir dans le format OpenAPI 3.0.</p>
<p>Néamoins, une description en pur OpenAPI 3.0 est insuffisante et il faut renseigner des informations complémentaires, notamment pour identifier l'API plus facilement et la sémantiser. Ces informations sont ajoutées en utilisant le format d'extensions autorisé par la spécification est les attributs supplémentaires sont de la forme <em>x-PropertyName</em>.</p>
<h3 id="identification-de-lapi">Identification de l'API</h3>
<p>La spécification OpenAPI 3.0 n'offre pas de mécanisme permettant d'identifier de manière unique un API. Cela pose différents problèmes :</p>
<ul>
<li>Il est difficile de suivre l'évolution de l'API, on ne sait pas si 2 descriptions similaires correspondent à 2 APIs différentes ou a 2 versions différentes d'une même API.</li>
<li>Certaines applications nécessitent des fonctionnalités particulières d'API qu'il est difficile de décrire sémantiquement. Une identification unique de l'API permet au moins de dire que les applications ont besoin de cette API (et plus précisément d'une version minimale) en particulier.</li>
</ul>
<p>Pour identifier de manière unique une API, nous avons choisi d'adopter <a href="https://github.com/zalando/restful-api-guidelines/blob/master/chapters/compatibility.adoc">ces recommandations</a> : il faut renseigner un attribut <code>x-api-id</code> dans le bloc <code>ìnfo</code>. Plus précisément, il doit avoir cette forme :</p>
<pre><code class="language-yaml">/info/x-api-id:
  type: string
  format: urn
  pattern: ^[a-z0-9][a-z0-9-:.]{6,62}[a-z0-9]$
  description: |
    Globally unique and immutable ID required to identify the API. The API
    identifier allows to reveal the history and evolution of an API as a
    sequence of API specifications. It enables validation tools to detect
    incompatible changes and incorrect semantic versions.</code></pre>
<h3 id="annotations-sémantiques">Annotations sémantiques</h3>
<p>Les annotations sémantiques permettent de préciser ce que font les différentes opérations d'une API. On peut d'une part typer plus précisément les données en entrée et en sortie en utilisant des ontologies (par exemple un code postal est plus précis qu'un entier) et d'autre part déterminer une plus grande diversité d'actions que les verbes HTTP qui sont très restreints.</p>
<p>Le format d'annotations sémantiques que nous avons choisi est décrit dans <a href="http://www.intelligence.tuc.gr/~petrakis/publications/SOAS4.pdf">cet article</a>. <em>x-operationType</em> permet de spécifier plus précisément l'action réalisée par l'opération. Nous conseillons d'utiliser le vocabulaire <a href="http://schema.org/Action">défini ici</a> dans les types spécifiques. Pour pouvoir être utilisé pour de l'enrichissement, un endpoint doit utiliser l'action <em>Search</em>. <em>x-refersTo</em> permet de typer les entrées et sorties avec des ontologies. Le vocabulaire à utiliser est décrit dans ce projet, dans le fichier <code>contract/vocabulary.json</code>.</p>
</div><div class="page-break"></div> <h2 class="text-h4 my-4 grey--text text--darken-3">
      3 - Collecteurs de données
    </h2> <div class="article"><p>Les collecteurs de données périodiques permettent de mettre à jour certains jeux de données spécifiques de manière automatisée. Il y a principalement 2 cas d'usage, mais on peut en imaginer d'autres :</p>
<ul>
<li><p>Mise à jour de jeux de données alimentés par des fichiers produits par d'autres traitement automatisés. Typiquement des traitements réalisés par des ETL avec en sortie des fichiers tabulaires ou cartographiques mis à disposition sur un espace d'échange (serveur HTTP ou FTP).</p>
</li>
<li><p>Mise à jour de données temps réel alimentés par des flux de données ayant des formats spécifiques. Cela concerne principalement des données IOT.</p>
<p>La collecte de données est assurée par le service open source <a href="https://github.com/data-fair-processings">Data Fair Processings</a>. Lorsque l'on souhaite collecter des données dans un nouveau format ou protocole d'échange, il faut développer un nouveau plugin. On peut distinguer 2 cas de figure. Soit la mise à disposition des données correspond à un standard qui n'est pas encore supporté, et dans ce cas le plugin peut être intégré directement dans Data Fair Processings via une merge request. Soit le plugin reste propriétaire ou correspond à un format/protocole trop spécifique pour être intégré directement dans le projet, et il est rajouté par configuration, lors de l'installation du service.</p>
</li>
</ul>
</div><div class="page-break"></div> <h2 class="text-h4 my-4 grey--text text--darken-3">
      5 - Connecteurs de catalogues
    </h2> <div class="article"></div></div></div></main></div></div></div></div><script defer src="/data-fair/master/_nuxt/static/1622724187/full/interoperate/state.js"></script><script src="/data-fair/master/_nuxt/06a154a.js" defer></script><script src="/data-fair/master/_nuxt/d96bad6.js" defer></script><script src="/data-fair/master/_nuxt/7f0cd2a.js" defer></script><script src="/data-fair/master/_nuxt/4cdf224.js" defer></script><script src="/data-fair/master/_nuxt/c90eb1d.js" defer></script>
  </body>
</html>
